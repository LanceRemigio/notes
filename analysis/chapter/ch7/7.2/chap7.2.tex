\section{The Definition of the Riemann Integral}

Before we have \textit{Riemann sums}, we need to construct \textit{upper sums}  and \textit{lower sums} using the notion of the supremum and infimum. In this section, let us assume that \( f  \) is defined on a closed interval \( [a,b]  \) where \( f  \) is bounded my some \( M > 0  \) on this interval; that is, \( | f(x)  | \leq M  \) for all \( x \in [a,b] \). 

\subsection{Partitions, Upper Sums, and Lower Sums}

\begin{definition}[Upper and Lower Sums]
	A \textit{partition} \( P  \) of \( [a,b]  \) is a finite set of points from \( [a,b]  \) that includes both \( a  \) and \( b  \). The notational convention is to always list the points of a partition \( P = \{ x_{0}, x_{1}, x_{2}, \dots, x_{n} \}  \) in increasing order; thus, \[  a = x_{0} < x_{1} < x_{2} < \dotsb < x_{n} = b. \]
	For each subinterval \( [x_{k-1}, x_{k} ] \) of \( P  \), let 
	\[  m_{k } = \inf \{ f(x) : x \in [x_{k-1} , x_{k } ] \} \ \text{ and } \  M_{k } = \sup \{ f(x) : x \in [x_{k-1}, x_{k }] \}. \]
	The \textit{lower sum} of \( f  \) respect to \( P  \) is given by 
	\[  L(f, P ) = \sum_{ k=1 }^{ n } m_{ k } ( x_{k } -  x_{ k -1 }). \]
	Likewise, we define the \textit{upper sum} of \( f  \) with respect to \( P  \) by 
	\[  U(f, P ) = \sum_{ k=1 }^{ n } M_k ( x_{k } - x_{ k -1 }). \]
\end{definition}

It is clear from this definition that 
\[  U(f, P ) \leq L(f, P ).\]  This inequality holds even with respect to different partitions.

\begin{definition}[Refinements of Partitions]
A partition \( Q  \) is a \textit{refinement} of a partition \( P  \) if \( Q  \) contains all of the points of \( P  \); that is, if \( P \subseteq Q  \).



\end{definition}

\begin{lemma}
If \( P \subseteq Q  \), then \( L(f,P) \leq L(f,Q)  \), and \( U(f,P ) \geq U(f,Q) \).
\end{lemma}

\begin{proof}
	First let us prove the inequality for the lower sums. Let \( P \subseteq Q  \). Suppose we refine \( P  \) by a adding a point \( z  \) to some subinterval \(  [x_{k-1}, x_{k }] \) of P. Then we have that 
	\begin{align*}
	    m_{k } ( x_{k } - x_{ k -1 })&= m_{  k } (x_{k } - z ) + m_{ k } (z - z _{k -1 })  \\
									 &\leq m'_{k }( x_{k } - z ) + m"_{k} (z - x_{k -1 }),
	\end{align*}
	where 
	\[  m'_{k} = \inf \{ f(x) : x \in [z, x_{k }] \} \  \ \text{ and } \  \ m"_{k} = \inf \{ f(x) : x \in [x_{k -1 }, z ] \}  \]
	are each necessarily as large or larget than \( m_k  \). We can use an induction argument to show that \(  L(f, P ) \leq L(f,Q) \). The same can be done for the upper sums.

	That is, take some point \( \ell \in [x_{k-1}, x_{k }] \) such that 
	\begin{align*}
	    M_{k } (x_{k} - x_{k -1 }) &= M_{k } (x_{ k } - \ell ) + M_{k } ( \ell - x_{k -1 }) \\
								   &\geq M_k' (x_{k } - \ell ) + M"_{k } (\ell - x_{k -1 }) \\
	\end{align*}
	\[  M'_{k} = \sup \{ f(x) : x \in [\ell, x_{k }] \} \  \ \text{ and } \  \ M"_{k}= \sup \{ f(x) : x \in [x_{k -1 }, \ell ] \}.  \]
	Using induction again to repeat the argument above, we can show that \( U(f, P) \geq U(f,Q) \).
\end{proof}

\begin{lemma}
	If \( P_1  \) and \( P_2  \) are any two partitions of \( [a,b]  \), then \( L(f, P_{1}) \leq U(f, P_2) \).
\end{lemma}

\begin{proof}
Let \( Q = P_{1} \cup P_{2}  \) be the so-called \textit{common refinement} of \( P_{1} \) and \( P_{2} \). Because \(  P_{1} \subseteq Q  \) and \( P_{2} \subseteq Q  \), it follows that 
\[ L(f, P_{1}) \leq L(f,Q) \leq U(f,Q) \leq U(f, P_{2}).  \]
\end{proof}


\subsection{Integrability}

Another way of thinking Integrability is to think of the upper sums as an overestimate of the value of the integral and lower sums as an underestimate of the value of the integral. We can see that as the we continually refine our partitions, the upper sums become smaller and smaller and the lower sums become larger and larger until they meet at some common point in the middle. 
	Rather than thinking of this whole process as the limit of these sums, we will instead make use of the Axiom of Completeness and consider the \textit{infimum} of the upper sums and the \textit{supremum} of the lower sums.

\begin{definition}[Upper and Lower Integrals]
	Let \( \mathcal{P}  \) be the collection of all possible partitions of the interval \( [a,b] \). The \textit{upper integral} of \( f \) is defined to be 
	\[  U(f) = \inf \{ U(f,P) : P \in \mathcal{P} \}.  \]
	In a similar way, define the \textit{lower integral} of \( f  \) by 
	\[  L(f) = \sup \{ L(f,P) : P \in \mathcal{P}. \}  \]
\end{definition}
 The following fact is not surprising. 

 \begin{lemma}
	For any bounded function \( f  \) on \( [a,b]  \), it is always the case that \( U(f) \leq L(f) \).
\end{lemma}

Why is this not surprising you ask? It is because \( U(f) \) is the exact definition for what it means to be the least upper bound and \( L(f)  \) is the exact definition for what it means to be the greatest upper bound.

\begin{definition}[Riemann Integrability]
	A bounded function \( f  \) defined on the interval \( [a,b] \) is \textit{Riemann-integrable} if \( U(f) = L(f) \). In this case, we define \( \int_{ a }^{ b } f   \) or \( \int_{ a }^{ b } f(x) \ dx \) to be this common value; namely, 
	\[  \int_{ a }^{ b } f  = U(f) = L(f). \]
\end{definition}

\subsection{Criteria for Integrability} 

To summarize, we know that it is always the case that for a bounded function  \( f  \) on a closed interval \( [a,b]  \), we have 
\[  \sup \{ L(f,P) : P \in \mathcal{P} \} = L(f) \leq U(f) = \inf \{ U(f,P) : P \in \mathcal{P} \}.\] For \( f  \) to be integrable, the inequaltity above must be an equality. More rigorously, finding our if a function is integrable is equivalent to the existence of partitions whose upper and lower sums are arbitrarly close together.

\begin{theorem}[Integrability Criterion]
		A bounded function \(  f \) is integrable on \( [a,b]  \) if and only if, for every \( \epsilon > 0  \), there exists a partition \( P_{\epsilon } \) of \( [a,b] \) such that 
		\[  U(f, P_{\epsilon }) - L(f, P_{\epsilon }) < \epsilon. \]
	\end{theorem}

\begin{proof}
	(\( \Leftarrow \))Let \( \epsilon > 0  \). If such a partition \( P_{\epsilon } \) of \( [a,b]  \) exists, then we have
	\[ U(f) - L(f) \leq U(f, P_{\epsilon }) - L(f, P_{\epsilon }) < \epsilon. \]
	Since \( \epsilon  \) is arbitrary, we know by Theorem 1.2.6 that \( U(f) = L(f) \).Hence, \( f  \) is integrable.  
	(\( \Rightarrow \)) 

	The proof for the forwards direction works more like using the triangle inequality but this time with parentheses in place of absolute values. Since \( U(f)  \) is just the greatest lower bound of the upper sums, we know that, given some \( \epsilon > 0  \), there must exists a partition \( P_{1} \) such that 
	\[  U(f, P_{1}) < U(f) + \frac{ \epsilon  }{ 2 }. \tag{1} \]
	Likewise, there exists a partition \( P_{2}  \) satisfying 
	\[  L(f, P_{2}) > L(f) - \frac{ \epsilon  }{ 2 } \iff -L(f, P_{2}  ) < \frac{ \epsilon  }{ 2 } - L(f). \tag{2} \]
	Adding (1) and (2) together, we end up with 
	\[  U(f, P_{1}) - L(f, P_{2}) < ( U(f) - L(f)) + \epsilon.  \]
	Because \( f  \) is integrable on \( [a,b]  \), we have \( L(f) = U(f)  \) which implies that 
	\begin{align*}
	    U(f, P_{\epsilon }) - L(f, P_{\epsilon}) &\leq  U(f, P_{1}) - L(f, P_{2})  \\
												 &< (U(f) - L(f)) + \epsilon \\
												 &= \epsilon.
	\end{align*}
\end{proof}

At the beginning of this section, it was clear that a function's integrability was tied to its continuity. To make this precise, let us consider the arbitrary partition \( P = \{ x_{0}, x_{1}, x_{2}, \dots, x_{n} \}  \) of \( [a,b]  \), and let us define \( \delta x_{k } = x_{k } - x_{k-1 } \). Then, 
\[  U(f,P) - L(f,P) = \sum_{ k=1 }^{ n } (M_{k } - m_{k } ) \Delta x_{ k }, \]
where \( M _{k }  \) and \( m_{ k }  \) are the supremum and infimum of \( f  \) on the subinterval \( [x_{k -1 } , x_{ k  }] \) (as defined before) respectively. The size of 
\[  U(f,P) - L(f,P)   \] is dependent upon the size of the differences of our extremums \(  M_{k } - m_{k } \), which can be interpreted as the variation of the range of \( f  \) over the interval \( [x_{k-1 }, x_{k }] \). This variation and its restriction of our function \( f  \) on arbitrarly small intervals on \( [a,b]  \) is \textit{precisely} what it means fopr \( f  \) to be uniformly continuous on \( [a,b] \).

\begin{theorem}[Continuity Implies Integrability]
	If \( f  \) is continuous on \( [a,b] \), then it is integrable.
\end{theorem}

\begin{proof}
	Since \( f  \) is continuous on the compact set \( [a,b]  \), we know that \( f  \) must be uniformly continuous on \( [a,b]  \). Let \( \epsilon > 0  \) and choose \( \delta = \epsilon / b -a  \) where \( b = x_{n}   \) and \( a = x_{1}  \) are the endpoints of the interval \( [a,b ] \). Then whenever \( | x - y  | < \delta  \), we have that 
	\[  | f(x) - f(y)  | < \frac{ \epsilon  }{  b - a  }. \]
	Now, let \( P  \) be a partition of \( [a,b]  \) where \( \Delta x_{ k } = x_{ k } - x _{ k -1 } \) is less than \( \delta  \) for every subinterval \( [x_{k-1 } , x_{k }] \) of \( P  \). Given a particular subinterval \( [x_{k-1}, x_{ k } ] \subseteq [a,b]   \), we can use the Extreme Value Theorem, to state that the supremum \(  M_{k} = f(z_{k })  \) for some \( z_{k } \in [x_{ k-1 } , x_{k}]  \) as well as the infimum \( m_{k } = f(y_{k }) \) for some \( y_{ k } \in [x_{k -1 } , x_{ k }]  \). But this means that whenever \( | z_{k } - y_{k } | < \delta  \), we have 
	\[  M_{k } - m_{k } = f(z_{k}) - f(y_{k } ) < \frac{ \epsilon  }{  b -a  }. \]
	This implies that 
	\[  U(f, P ) - L(f,P ) = \sum_{ k=1 }^{ n } (M_{k } - m_{ k } ) \Delta x_{k} < \frac{ \epsilon  }{ b -a  }  \sum_{ k=1 }^{ n } \Delta x_{k} = \epsilon \]
	and \( f  \) is integrable by the criterion provided in Theorem 7.2.8.
\end{proof}



